<script type="text/javascript">
$.fn.toggle = function( fn, fn2 ) {
    var args = arguments,guid = fn.guid || $.guid++,i=0,
    toggle = function( event ) {
      var lastToggle = ( $._data( this, "lastToggle" + fn.guid ) || 0 ) % i;
      $._data( this, "lastToggle" + fn.guid, lastToggle + 1 );
      event.preventDefault();
      return args[ lastToggle ].apply( this, arguments ) || false;
    };
    toggle.guid = guid;
    while ( i < args.length ) {
      args[ i++ ].guid = guid;
    }
    return this.click( toggle );
}
function wli(){
	var wsp0=0;
	var wsp=$('.content_ul_w ul li').eq(0).children('span');
	for( var i=0; i<wsp.length;i++){
		wsp0+=wsp.eq(i).outerWidth();
	}
	$('.content_ul_w ul li').css('width',wsp0);	
}
wli();

//全选
$('#all').click(function(){
	if(this.checked){                                     
		$("[name=box]:checkbox").prop("checked",true);  
	}else{
		$("[name=box]:checkbox").prop("checked",false);  
	}	
});

//checkbox
$("#qk").click(function(){
	$('input[type="checkbox"]').prop({
        checked: false
      })	
})
$('input[type="checkbox"]').change(function(e) {

  var checked = $(this).prop("checked"),
      container = $(this).parent(),
      siblings = container.siblings();

  container.find('input[type="checkbox"]').prop({
    indeterminate: false,
    checked: checked
  });

  function checkSiblings(el) {

    var parent = el.parent().parent(),
        all = true;

    el.siblings().each(function() {
      return all = ($(this).children('input[type="checkbox"]').prop("checked") === checked);
    });

    if (all && checked) {

      parent.children('input[type="checkbox"]').prop({
        indeterminate: false,
        checked: checked
      });

      checkSiblings(parent);

    } else if (all && !checked) {

      parent.children('input[type="checkbox"]').prop("checked", checked);
      parent.children('input[type="checkbox"]').prop("indeterminate", (parent.find('input[type="checkbox"]:checked').length > 0));
      checkSiblings(parent);

    } else {

      el.parents("li").children('input[type="checkbox"]').prop({
        indeterminate: true,
        checked: false
      });

    }

  }

  checkSiblings(container);
});



$("li img").each(function(){
	$(this).toggle(function(){
		$(this).attr('src','img/hl.png')
		$(this).parent('li').children('ul').slideDown()
	},function(){
		$(this).attr('src','img/zk.png')	
		$(this).parent('li').children('ul').slideUp()
	})
})

$("#gb1").click(function(){
	$(".gs_c").slideUp()	
})
$("#gb2").click(function(){
	$(".bm_c").slideUp()	
})
$("#gb3").click(function(){
	$(".gw_c").slideUp()	
})
$('#gs').click(function(){
	$(".gs_c").slideDown();
})
$('#bm').click(function(){
	$(".bm_c").slideDown();
})
$('#gw').click(function(){
	$(".gw_c").slideDown();
})

$(function(){
	$('#gs').click(function(){
		$(".gs_c").slideDown();
	})
    var M1 = $('.gs_a')
    M1.on('click',function(e){e.stopPropagation();})
    .find('div[class="ss"]').on('click',function(){
        M1.find('.gs_c').show();
    });
    $(document).on('click',function(){M1.find('.gs_c').hide()})
})
$(function(){
	$('#bm').click(function(){
		$(".bm_c").slideDown();
	})
    var M1 = $('.bm_a')
    M1.on('click',function(e){e.stopPropagation();})
    .find('div[class="ss"]').on('click',function(){
        M1.find('.bm_c').show();
    });
    $(document).on('click',function(){M1.find('.bm_c').hide()})
})
$(function(){
	$('#gw').click(function(){
		$(".gw_c").slideDown();
	})
    var M1 = $('.gw_a')
    M1.on('click',function(e){e.stopPropagation();})
    .find('div[class="ss"]').on('click',function(){
        M1.find('.gw_c').show();
    });
    $(document).on('click',function(){M1.find('.gw_c').hide()})
})

$("#qr1,#qx1").click(function(){
	$(".gs_c").slideUp()	
})
$("#qr2,#qx2").click(function(){
	$(".bm_c").slideUp()	
})
$("#qr3,#qx3").click(function(){
	$(".gw_c").slideUp()	
})

function add() {
	$("#opmode").val("add");
	$("#id").val("");
	if (check_form("form_data")){
		sendForm("form_data", "{:U('save')}", "__SELF__");
	}
};

function del() {
	var vars = $("#form_data").serialize();
	ui_confirm('确定要删除吗?',function(){
		sendAjax("{:U('del')}", vars, function(data){
			if (data.status) {
				ui_alert(data.info,function(){
					location.reload();
				});
			}
		});
	})
}

function save() {
	if (check_form("form_data")) {
		sendForm("form_data", "{:U('save')}", "__SELF__");
	}
}

function showdata(result) {
	for (var s in result.data) {
		set_val(s, result.data[s]);
	}
	$("#opmode").val("edit");
}

</script>