<script>
function wli(){
	var wsp0=0;
	var wsp=$('.content_ul_w ul li').eq(0).children('span');
	for( var i=0; i<wsp.length;i++){
		wsp0+=wsp.eq(i).outerWidth();
	}
	$('.content_ul_w ul li').css('width',wsp0);	
}
wli();

$('#a_lbtj').click(function(){
	$('#tc_xztypz').show();
	$(".bottom_sp3,.bottom_sp4").click(function(){
		$("#tc_xztypz").hide();	
	});
});
$('.content_bj').click(function(){
	$('#tc_xztypzbj').show();
	$(".bottom_sp3,.bottom_sp4").click(function(){
		$("#tc_xztypzbj").hide();	
	});
});
$('.content_fz').click(function(){
	$('#tc_xztypzfz').show();
	$(".bottom_sp3,.bottom_sp4").click(function(){
		$("#tc_xztypzfz").hide();	
	});
});
$('#all').click(function(){
	if(this.checked){                                     
		$("[name='id[]']:checkbox").prop("checked",true);  
	}else{
		$("[name='id[]']:checkbox").prop("checked",false);  
	}	
});
function del() {
	var vars = $("#form_data_scwf").serialize();
	ui_confirm('确定要删除吗?',function(){
	sendAjax("{:U('del')}", vars, function(data) {
	if (data.status) {
		ui_alert(data.info,function(){
			$("input[name='id[]']:checkbox:checked").each(function() {
			$(this).parents("li").remove();
					});
				});				
			}
		});
	});
}
$(".change_dept").change(function(){
	var pid=$(this).val();
	$.ajax({
		type: "post",
		url: "{:U('ajax_get_dept')}",
		data:{pid:pid},
		dataType: "json",
		success:function(result){
			$(".change_pos").html(result);
		}
	})
})
$(".change_pos").change(function(){
	var dep_id=$(this).val();
	$.ajax({
		type:'post', 
		url: "{:U('ajax_get_pos')}",
		data:{dep_id:dep_id},
		dataType: "json",
		success: function(result){
			$(".get_pos").html(result);
		},
		error:function(e){
		}
	});
})
function show(id,company_id,dept_id,pos_id,remark){
	$("#typz_id").val(id);
	$("#change_dept option").each(function(){
		if($(this).val() == company_id){
			$(this).prop('selected','true');
		}
	})
	$.ajax({
		type:'post', 
		url: "{:U('ajax_get_dept')}",
		data:{pid:company_id},
		dataType: "json",
		success: function(result){
			$("#change_pos").html(result);
			$("#change_pos option").each(function(){
				if($(this).val() == dept_id){
					$(this).prop('selected','true');
				}
			})
		},
		error:function(e){
		}
	});
	$.ajax({
		type:'post', 
		url: "{:U('ajax_get_pos')}",
		data:{dep_id:dept_id},
		dataType: "json",
		success: function(result){
			$("#get_pos").html(result);
			$("#get_pos option").each(function(){
				if($(this).val() == pos_id){
					$(this).prop('selected','true');
				}
			})
		},
		error:function(e){
		}
	});
	 
	$("#typz_remark").val(remark);
}
function save(){
	var id=$("#typz_id").val();
	var company_id=$("#change_dept").val();
	var dept_id=$("#change_pos").val();
	var pos_id=$("#get_pos").val();
	var remark=$("#typz_remark").val();
	$.ajax({
		type: "post",
		url: "{:U('edit')}",
		data:{id:id,company_id:company_id,dept_id:dept_id,pos_id:pos_id,remark:remark},
		dataType: "json",
		success:function(result){
			if(result.data){
				ui_alert("编辑成功",function(){
					location.reload();
				});
			}else{
				ui_alert('编辑失败',function(){
					location.reload();
				});	
			}
		}
	})
}
function set_version(id,pos_id){
	$.ajax({
		url:"{:U('update_version')}",
		data:{id:id,pos_id:pos_id},
		type:'post',
		success:function(data){
		ui_alert("设置成功",function(){
			location.reload();
		});
		},
		error:function(e){
		ui_alert("系统发生错误",function(){
		});
	}
	});
}
</script>