<layout name='Layout/ace_layout' />
<style>
<!--
/*top*/
.zong{ overflow:auto;margin-top:0px;}

/*content_title*/
.content_title{ background:#bdd3e0; height:40px; line-height:40px; margin-top:10px; position:relative;}
.content_sp1{ display:block; position:absolute;width:6px; height:20px; background-color:#20b891; border:solid 1px #3da396;top:10px; border-radius:3px;left:20px;}
.content_sp2{ display:block; font-size:12px; left:40px; position:absolute;}
.img_tj{ display:block; float:left; margin-top:14px;}
.content_sp3{display:block;position:absolute;right:20px;font-size:12px; color:#4c6456; font-weight:bold; cursor:pointer; overflow:hidden;}
.content_sp3 span{ display:block; float:left;}

/*content*/
.content_t{overflow:auto; float:left; margin-left:1%; width:83%;}
.content_ul_w{ overflow:auto; height:270px;}
.content_li{border-bottom:1px solid #eaedf1; background:#fff; overflow:hidden; height:28px;}
.content_li span{ display:block; float:left; white-space:nowrap;color:#323232; font-size:12px; height:28px;line-height:28px; text-align:center;}
.span1_0{ width:30px; font-weight:bold;}
.span1{ font-weight:bold; width:201px;}
.span2_0{ width:30px;}
.span2{ width:200px;}
.content_a{ display:block; height:28px; line-height:28px;font-size:12px; color:#22bd9b; font-weight:bold; cursor:pointer;}

/*bottom*/
.content_bottom1{ background:#fff; height:30px; margin-top:10px;}
.content_bottom2{ background:#fff; height:42px; margin-top:2px; line-height:42px; position:relative;}
.b1{ margin-left:10px; position:absolute; overflow:hidden;}
.b1 input{ float:left; margin-top:15px;}
.b1 span{ display:block; font-size:12px; color:#323232; float:left; margin-left:2px;}
.b2{ width:32px; height:20px; line-height:20px; border:solid 1px #ced3d7; background:#d0e0e7; color:#323232; float:left; font-size:12px; text-align:center; position:absolute; left:60px; top:11px; cursor:default;}
.b3{ height:20px; line-height:20px; position:absolute; right:360px; top:11px; border: solid 1px #13b58e;}
.b3_s1{ font-size:12px; color:#13b58e;}
.b3_s2{ font-size:12px; color:#323232;}

.b4{ height:20px; line-height:20px; position:absolute; right:280px; top:11px; color:#323232; font-size:12px;}
.b5{ height:20px; line-height:20px; position:absolute; right:15px; top:11px;}
.b5_s1{ color:#13b58e; font-size:12px; border: solid 1px #13b58e; padding:0 3px; cursor:pointer;}
.b5_s3 input{ color:#323232; width:25px; font-size:12px; border: solid 1px #13b58e;}
.b5_s2{ color:#fff; background:#13b58e;}

/*新增*/
.tc{ width:100%; height:100%; position:fixed; top:0; left:0; background:rgba(0,0,0,0.5); z-index:800; display: none;}
.tc_title{ width:100%; height:50px; line-height:50px; overflow:hidden; border-bottom:solid 1px #bdd3e0;}
.js_sp1{ float:left; display:block; font-size:18px; font-weight:bold; color:#22bd9b; margin-left:50px;}

.tc_div1{background:#f1f5fa; width:800px; height:500px; position:absolute; left:50%; margin-left:-400px; top:50%; margin-top:-300px; border-radius:5px;}
.tc_ul_div1{ width:700px; height:360px;margin-top:10px;margin-bottom:20px; margin-left:50px; overflow:auto;}
.tc_ul_s{ height:auto;}
.tc_ul_s li{ overflow:hidden; height:46px; font-size:14px; position:relative;}
.tc_ul_s .tc_li1{height: 110px;}
.tc_ul_s .tc_li2{height: 200px;}
.tc_ul_s label{ position:absolute; left:0;line-height:48px;}
.tc_ul_s span{ display:block; position:absolute; left:85px;}
.tc_ul_s select{ width:195px;position:absolute; left:85px; top:15px;}
.tc_ul_s textarea{width:380px; height: 80px; position:absolute; left:85px; top:15px;}
.tc_ul_s a{display: block;position:absolute; left:85px; top:15px;color: #22bd9b; cursor: pointer; font-weight: bold;}
.tc_inp{ width:190px;position:absolute; left:85px; top:15px;}
.gz_k{position:absolute; left:85px; top:15px;width:610px; height: 224px; background: #fff; display: none;}
.gz_title{height:24px; background: #dcdcdc; position: relative; line-height: 24px;}
.gz_title span{display: block; position: absolute; left: 5px; font-size: 10px;}
.gz_title img{display: block;position: absolute; right: 5px; top: 4px; padding: 3px; cursor: pointer;}

.gz_con li{height: 20px; font-size: 10px; margin-left: 3px; float: left;}
.gz_con_d1{overflow: hidden; border-top:1px solid #eee; height: 20px;}
.gz_con_d1 div{ height: 20px; line-height: 20px;}
.gz_con_d2{overflow: hidden; border-top:1px solid #eee;}
.gz_d1_1{ color:#666; width: 55px; text-align: right;float: left;font-size: 10px;}
.gz_d1_2{color: #22bd9b;float: left; width: 555px;font-size: 10px; height: 44px; overflow: auto;}

.bottom_sp3{ display:block; width:80px; height:36px; float:left; background:#475c6f; color:#fff; line-height:36px; text-align:center; font-size:14px; border-radius:3px; margin-left:100px; margin-right:40px; cursor:pointer;}
.bottom_sp4{ display:block; width:80px; height:36px; float:left; background:#1fb992;color:#fff; line-height:36px; text-align:center; font-size:14px; border-radius:3px;cursor:pointer;}

-->
</style>
<div class="zong">
	<div class="content">
    	<div class="content_title">
            <span class="content_sp1"></span>
            <span class="content_sp2">{$flow_name} {$version} 节点列表</span>
            <a class="content_sp3" id="a_lbtj">
            	<img class="img_tj" src="__PUBLIC__/img/tj3.png"/>
            </a>  
        </div>
        <div class="content_ul_w" id="content_div2">
            <ul class="content_ul">
                <li class="content_li">
                    <span class="span1_0"></span>
                    <span class="span1">节点分类</span>
                    <span class="span1">节点名称</span>
                    <span class="span1">执行模式</span>
                    <span class="span1">警示时间</span>
                    <span class="span1">超时时间</span>
                    <span class="span1">合并策略</span>
                    <span class="span1">操作</span>
                    <span class="span1"></span>
                </li>
                <empty name="list">
					<li style="border: 1px solid #eaedf1;border-top: 0px;line-height: 120px;text-align: center;font-size: 24px;">
						没找到数据
					</li>
				<else/>
				<form method="post" action="" name="form_data_sc" id="form_data_sc">
	                <foreach name="list" item="vo">
		                <li class="content_li">
		                    <span class="span2_0"><input name="id[]" type="checkbox" value="{$vo.id}"/></span>
		                    <span class="span2">{$vo.node_type}</span>
		                    <span class="span2">{$vo.node_name}</span>
		                    <span class="span2"></span>
		                    <span class="span2"></span>
		                    <span class="span2"></span>
		                    <span class="span2"></span>
		                    <span class="span2"><a class="content_a a_lbbj" node="{$vo.id}" sort="{$vo.sort}">编辑</a></span>
		                    <span class="span2"><a class="content_a a_idpz" node="{$vo.id}" rule_expression="{$vo.rule_expression}" rule_explain="{$vo.rule_explain}">节点配置</a></span>
		                </li>
	                </foreach>
	            </form>
	            </empty>
            </ul>
        </div> 
        <div class="content_bottom">
	        <div class="content_bottom2">
	        <php>if(isAction('flow_node/del')){</php>
	        	<div class="b1">
	                <input id="all" type="checkbox"/>
	                <span>全选</span>
	            </div>
	         <div class="b2"><a onclick="del();">删除</a> </div><php>}</php>
	          <div class="pagination" style="float:right;line-height:25px;">
	                {$page}
	          </div>
		    </div> 
		</div>     
    </div>
</div>

<form method="post" action="{:U('save')}" name="form_data_add" id="form_data_add">
<input name="opmode" type="hidden" value="add"/>
<input type="hidden" name="flow_version_id" value="{$Think.get.flow_version_id}"/>
<div class="tc" id="tc_xzjd">
	<div class="tc_div1">
    	<div class="tc_title">
        	<span class="js_sp1" id="bj1">添加节点</span>
        </div>
        <div class="tc_ul_div1">
            <ul class="tc_ul_s">
                <li>
                    <label>节点分类：</label>
                    <select name="node_type">
                    	<option>活动的</option>
                    	<option>自由节点</option>
                    	<option>关键节点</option>
                    	<option>条件节点</option>
                    </select>
                </li>
                <li>
                    <label>节点名称：</label>
                    <input class="tc_inp" type="text" name="node_name"/>
                </li> 
                <li>
                    <label>排序：</label>
                    <input class="tc_inp" type="text" name="sort"/>
                </li>
                
            </ul>
        </div>
        
        <div class="bottom2">
        	<span class="bottom_sp3">取消</span>
            <span class="bottom_sp4" onclick="$('#form_data_add').submit()">确定</span>
        </div>
    </div>
</div>
</form>

<form method="post" action="{:U('save')}" name="form_data_edit" id="form_data_edit">
<input name="opmode" type="hidden" value="edit"/>
<input name="id" id="id" type="hidden" />
<div class="tc" id="tc_xzjd2">
	<div class="tc_div1">
    	<div class="tc_title">
        	<span class="js_sp1" id="bj1">编辑节点</span>
        </div>
        <div class="tc_ul_div1">
            <ul class="tc_ul_s">
                <li>
                    <label>节点分类：</label>
                    <select name="node_type" id="node_type">
                    	<option>活动的</option>
                    	<option>自由节点</option>
                    	<option>关键节点</option>
                    	<option>条件节点</option>
                    </select>
                </li>
                <li>
                    <label>节点名称：</label>
                    <input class="tc_inp" type="text" name="node_name" id="node_name"/>
                </li> 
                <li>
                    <label>排序：</label>
                    <input class="tc_inp" type="text" name="sort" id="sort"/>
                </li>
                
            </ul>
        </div>
        
        <div class="bottom2">
        	<span class="bottom_sp3">取消</span>
            <span class="bottom_sp4" onclick="$('#form_data_edit').submit()">确定</span>
        </div>
    </div>
</div>
</form>

<form method="post" action="{:U('save')}" name="form_data_edit2" id="form_data_edit2">
<input name="opmode" type="hidden" value="edit"/>
<input name="id" id="idd" type="hidden" />
<div class="tc" id="tc_pzjd">
	<div class="tc_div1">
    	<div class="tc_title">
        	<span class="js_sp1">配置节点</span>
        </div>
        <div class="tc_ul_div1">
            <ul class="tc_ul_s">
                <li class="tc_li1">
                    <label>规则表达式：</label>
                    <textarea name="rule_expression" id="rule_expression"></textarea>
                </li>
                <li>
                    <label>规则解释：</label>
                    <input class="tc_inp" type="text" name="rule_explain" id="rule_explain"/>
                </li> 
                <li class="tc_li2">
                    <label>参数与规则：</label>
                    <a id="tc_gz">规则</a>
                    <div class="gz_k">
                    	<div class="gz_title">
                    		<span>参数与规则</span>
                    		<img id="gz_gb" src="__PUBLIC__/img/gz_gb.png"/>
                    	</div>
                    	<div class="gz_con">
                    		<div class="gz_con_d1">
                    			<div class="gz_d1_1">表达式</div>
                    			<div class="gz_d1_2">
                    				<ul>
                    					<li>本公司的人事专员</li>
                    				</ul>
                    			</div>
                    		</div>
                    		<div class="gz_con_d2">
                    			<div class="gz_d1_1">函数</div>
                    			<div class="gz_d1_2">
                    				<ul>
										<li>{GetMyLeader(16,27)}</li>
									</ul>
                    			</div>	
                    		</div>
                    		<div class="gz_con_d2">
                    			<div class="gz_d1_1">系统参数</div>
                    			<div class="gz_d1_2">
                    				<ul>
										<li>{GetMyLeader}</li>
										<li>{GetMyLeader}</li>
										<li>{GetMyLeader}</li>
										<li>{GetMyLeader}</li>
									</ul>
                    			</div>
                    		</div>
                    		<div class="gz_con_d2">
                    			<div class="gz_d1_1">表单参数</div>
                    			<div class="gz_d1_2">
                    				<ul>
                    					<foreach name="fields" item="field">
                    						<li>{$field}</li>
                    					</foreach>
									</ul>
                    			</div>
                    		</div>
                    	</div>
                    </div>
                </li>
                
            </ul>
        </div>
        
        <div class="bottom2">
        	<span class="bottom_sp3">取消</span>
            <span class="bottom_sp4" onclick="$('#form_data_edit2').submit()">确定</span>
        </div>
    </div>
</div>
</form>
